<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    
</body>
</html>
<script>
    //promise
//1.promise
//2.executor


//-- trạng thaí
//1.pendding
//2. fullfilled
//3. rejected
    var promise=new Promise(
        //executor
        function(resolve,reject)//win and fail
        {
            //logic
            //win: resolve()
            //fail:reject()
            //fake call api
            resolve([
                {
                    id:20,
                    name:'Thang',
                    age:20
                }
            ])
        }
    )

promise
.then(function(code)
{
    console.log(code);
})
.catch(function()
{
    console.log('fail');
})
.finally(function()
{
    console.log('done!');
})


//ex 2
var promise=new Promise(
        //executor
        function(resolve,reject)//win and fail
        {
            //logic
            //win: resolve()
            //fail:reject()
            reject('file error')
        }
    )

promise
.then(function(code)
{
    console.log(code);
})
.catch(function(error)
{
    console.log(error);
})
.finally(function()
{
    console.log('done!');
})


//promise chain
var promise=new Promise(
        //executor
        function(resolve,reject)//win and fail
        {
            //logic
            //win: resolve()
            //fail:reject()
            //fake call api
            resolve()
        }
    )

promise
.then(function()
{
    return 1 //cái dưới nhận được giá trị trả về
})
.then(function(data)
{
    console.log(data);
    return 2
})
.catch(function(error)
{
    console.log(error);
})
.finally(function()
{
    console.log('done!');
})


////ex 2-3
var promise=new Promise(
        //executor
        function(resolve,reject)//win and fail
        {
            //logic
            //win: resolve()
            //fail:reject()
            //fake call api
            resolve()
        }
    )

promise
.then(function()
{
    return new Promise(function(resolve)
    {
        setTimeout(function()
        {
            resolve([1,2,3])
        },3000)
    }
    )
})
.then(function(data)
{
    console.log(data);
    return 2
})
.catch(function(error)
{
    console.log(error);
})
.finally(function()
{
    console.log('done!');
})




///ex2 chain

function sleep(ms)
{
    return new Promise(function(resolve)
    {
        setTimeout(resolve,ms )
    })
}
sleep(1000)
.then(function()
{
    console.log(1);
    return sleep(1000);
})
.then(function()
{
    console.log(2);
    return sleep(1000)
})
.then(function()
{
    console.log(5);
    return sleep(1000)
})
.then(function()
{
    console.log(4);
    return sleep(1000)
})



//ex3
function eating(code)
{
    return new Promise( function(resolve)
    {
        setTimeout(resolve,code)
    })
}
eating(2000)
.then(function()
{
    console.log('successfully!',1);
    return eating(2000)
})

.then(function()
{
    console.log('successfully!',2);
    return eating(2000)
})

.then(function()
{
    console.log('successfully!',4);
    return eating(2000)
})





</script>